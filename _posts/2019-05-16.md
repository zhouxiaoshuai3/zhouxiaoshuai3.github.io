---
layout: post
title: MySQL  之  Insert into，Replace Into，Insert ignore
date: 2019-05-16 
tags: MySQL  
---
 
<section data-role="outer" label="Powered by 135editor.com" style="font-size:16px;"><section data-role="outer" label="Powered by 135editor.com" style="font-size:16px;"><section class="_135editor" data-tools="135编辑器" data-id="93209" style="border: 0px none; background-color: rgba(0, 0, 0, 0); padding: 0px; background-image: url(&quot;https://mpt.135editor.com/mmbiz_png/cZV2hRpuAPgbHyW9JLVGVygYHNEx5OYce0m8qDmrb0umhicJibAu6AmiauHd8vTN4uH8QOoThVCoEd2T5Eb99LDow/0?wx_fmt=gif&quot;); background-repeat: repeat; box-sizing: border-box;" data-color="#80b135"><section style="padding: 10px; box-sizing: border-box;"><section style="width: 100%;text-align: center;" data-width="100%"><section style="display: inline-block;width: auto"><section style="height: 35px;background-color: #e9beff;margin-right: 5px;margin-left: -5px;background:url(https://image2.135editor.com/cache/remote/aHR0cHM6Ly9tbWJpei5xbG9nby5jbi9tbWJpel9wbmcvN1FSVHZrSzJxQzVBdXE2cHY4ODZOUHJMSVU1cWgwZ3ZkN0VScE53NlpqT3pjUW00WTVrd0RZdUR6RGljdk9mazlpY3hvYUU1Qjd5TlNPY25GUHp6SXdqZy8w);"></section><section style="height: 35px; padding: 0px 15px; margin-top: -30px; background-color: #80b135; line-height: 35px; color: #ffffff; box-sizing: border-box;"><p class="135brush" data-brushtype="text" style="font-size: 14px; text-align: center; letter-spacing: 0px; line-height: 1.5em; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">MySQL 数据迁移知多少？！</p></section></section></section></section></section><section class="_135editor" data-tools="135编辑器" data-id="93073" style="border: 0px none; box-sizing: border-box; background-color: rgba(0, 0, 0, 0); background-image: url(&quot;https://mpt.135editor.com/mmbiz/yqVAqoZvDibFBUtBHL9Y5sfbCFHfUGuqExxBdyiceVr6AmeCNjLeibibDPUic8bRkgK4X8Ria9ErYIb44KsBoA9cB31g/0?wx_fmt=jpeg&quot;); background-repeat: repeat; padding: 0px;" data-color="#80b135"><section><section style="width: 90%; margin-left: 5%; margin-bottom: 10px; padding: 5px 0px; font-size: 14px; letter-spacing: 1.5px; line-height: 2em; color: #3f3f3f; box-sizing: border-box;" class="135brush" data-width="90%"><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">&nbsp; &nbsp;平时工作中经常需要对旧数据进行维护，数据迁移的操作。</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">今天就来分享一篇 MySQL 数据迁移填坑记！</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">&nbsp;&nbsp;&nbsp;&nbsp;需求是这样的，把 A 表的数据 维护到 B 表中，且两张表的字段相同，一个主键 id，一个唯一索引 phone ，此时 B 表中已经有少量数据。<br></p></section></section></section><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">&nbsp; &nbsp; 思路分析：</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">&nbsp;&nbsp;&nbsp;&nbsp;1. 可以直接从 B 表查询导入到 A 表中，同时要避免 ID 冲突问题；<br></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">&nbsp;&nbsp;&nbsp;&nbsp;2. 导入数据时 需要避免 唯一索引 phone 字段 不能冲突，如果 A 表中已经存在的 phone，不需要从 B 表中导入。</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">&nbsp;&nbsp;&nbsp;&nbsp;开始跳坑：<br></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">&nbsp;&nbsp;&nbsp;&nbsp;看到这个需求感觉挺简单的，几句 SQL 就可以完美解决。<br></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">可是万万没想到啊，又掉坑了。</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">&nbsp;&nbsp;&nbsp;&nbsp;原来 MySQL 的插入语句有很多种，今天就来聊聊 MySQL 插入语句的几种方式。</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><br></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">&nbsp;&nbsp;MySQL 插入总结：</p><section class="_135editor" data-tools="135编辑器" data-id="2185" style="border: 0px none; box-sizing: border-box;" data-color="#80b135"><section class="_135editor" data-tools="135编辑器" data-id="2185" style="border: 0px none; box-sizing: border-box; margin: 0px auto; width: 100%;" data-color="#80b135" data-custom="#80b135" data-width="100%"><section style="color: inherit; font-size: 16px; padding: 5px 10px 0px 35px; margin-left: 27px; border-left: 2px dotted #e4e4e4; box-sizing: border-box;"><section class="autonum" style="width: 32px; height: 32px; margin-left: -53px; margin-top: 23px; color: #ffffff; text-align: center; line-height: 32px; border-radius: 16px; background: #80b135; box-sizing: border-box;" data-original-title="" title="">1</section><section class="135brush" style="margin-top: -30px; padding-bottom: 10px; font-size: 14px; text-align: justify; letter-spacing: 1.5px; color: inherit; box-sizing: border-box;"><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">insert into ：</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">insert into 用于直接插入数据，可以指定 id 为主键自增 或者自定义 id 的值；</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">创建如下数据表：</p><pre style="background-color: rgb(39, 40, 34); color: rgb(207, 191, 173); font-size: 13.5pt; font-family: &quot;Source Code Pro&quot;;"><span style="font-size: 18px;"><span style="color: #ff007f;"></span></span></pre><pre style="background-color: rgb(39, 40, 34); color: rgb(207, 191, 173); font-size: 13.5pt; font-family: &quot;Source Code Pro&quot;;"><span style="color:#ff007f;">CREATE TABLE </span><span style="color:#52e3f6;">`test3` </span><span style="color:#f9faf4;">(<br></span><span style="color:#f9faf4;"> &nbsp; &nbsp; &nbsp;</span>`id` <span style="color:#ff007f;">int</span><span style="color:#f9faf4;">(</span><span style="color:#c48cff;">11</span><span style="color:#f9faf4;">) </span><span style="color:#ff007f;">NOT NULL AUTO_INCREMENT,<br></span><span style="color:#ff007f;"> &nbsp; &nbsp; &nbsp;</span>`name` <span style="color:#ff007f;">varchar</span><span style="color:#f9faf4;">(</span><span style="color:#c48cff;">50</span><span style="color:#f9faf4;">) </span><span style="color:#ff007f;">DEFAULT NULL,<br></span><span style="color:#ff007f;"> &nbsp; &nbsp; &nbsp;</span>`age` <span style="color:#ff007f;">int</span><span style="color:#f9faf4;">(</span><span style="color:#c48cff;">11</span><span style="color:#f9faf4;">) </span><span style="color:#ff007f;">DEFAULT NULL,<br></span><span style="color:#ff007f;"> &nbsp; &nbsp; &nbsp;PRIMARY KEY </span><span style="color:#f9faf4;">(</span>`id`<span style="color:#f9faf4;">)</span><span style="color:#ff007f;">,<br></span><span style="color:#ff007f;"> &nbsp; &nbsp; &nbsp;UNIQUE KEY </span>`name` <span style="color:#f9faf4;">(</span>`name`<span style="color:#f9faf4;">)<br></span><span style="color:#f9faf4;">) </span><span style="color:#ff007f;">ENGINE</span>=InnoDB <span style="color:#ff007f;">DEFAULT CHARSET</span>=utf8mb4 <span style="color:#ff007f;">COLLATE</span>=<span style="color:#52e3f6;">utf8mb4_0900_ai_ci</span></pre><pre style="background-color: rgb(39, 40, 34); color: rgb(207, 191, 173); font-size: 13.5pt; font-family: &quot;Source Code Pro&quot;;"><span style="font-size: 18px;"><span style="color: #ff007f; font-size: 18px;"></span></span></pre><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">查看此时数据表中的数据为空：<br></p><pre style="background-color: rgb(39, 40, 34); color: rgb(207, 191, 173); font-size: 13.5pt; font-family: &quot;Source Code Pro&quot;;"><span style="color:#ff007f;">select </span><span style="font-style:italic;">* </span><span style="color:#ff007f;">from </span><span style="color:#52e3f6;">test3</span><span style="color:#ff007f;">;</span></pre><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><br></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><img src="http://image.135editor.com/files/users/576/5766750/201905/Kjcwm6kf_eAuU.png" data-ratio="1" alt="屏幕快照 2019-05-16 下午11.30.07.png" style="letter-spacing: 0px; text-indent: 0em; caret-color: red;"><br></p><ol class=" list-paddingleft-2" style="list-style-type: decimal; margin: 0px; padding: 0px 0px 0px 30px;"><li><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">insert into 用法一：指定所有字段</p></li></ol><pre style="background-color: rgb(39, 40, 34); color: rgb(207, 191, 173); font-size: 13.5pt; font-family: &quot;Source Code Pro&quot;;"><span style="font-size: 18px;"><span style="color: #ff007f;">insert into </span><span style="color: #52e3f6;">test3</span><span style="color: #f9faf4;">(</span>id<span style="color: #ff007f;">, name, </span>age<span style="color: #f9faf4;">) </span><span style="color: #ff007f;">value </span><span style="color: #f9faf4;">(</span><span style="color: #c48cff;">1</span><span style="color: #ff007f;">, </span><span style="color: #ece47e;">'Lucy'</span><span style="color: #ff007f;">, </span><span style="color: #c48cff;">19</span><span style="color: #f9faf4;">)</span><span style="color: #ff007f;">;</span></span></pre><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><br></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><img src="http://image.135editor.com/files/users/576/5766750/201905/uQdVzvZX_GJEG.png" data-ratio="1" alt="屏幕快照 2019-05-16 下午11.35.51.png">现在顺利在数据表中写入一行数据。</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">&nbsp; 2. insert into 用法二：不指定 id ,按照系统自增</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">步骤 1 中在数据表中插入一条 id 为 1 的数据，</p><pre style="background-color: rgb(39, 40, 34); color: rgb(207, 191, 173); font-size: 13.5pt; font-family: &quot;Source Code Pro&quot;;"><span style="color:#ff007f;">insert into </span><span style="color:#52e3f6;">test3</span><span style="color:#f9faf4;">(</span><span style="color:#ff007f;">name, </span>age<span style="color:#f9faf4;">) </span><span style="color:#ff007f;">value </span><span style="color:#f9faf4;">(</span><span style="color:#ece47e;">'tom'</span><span style="color:#ff007f;">, </span><span style="color:#c48cff;">15</span><span style="color:#f9faf4;">)</span><span style="color:#ff007f;">;<br></span></pre><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><br></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">当 ID 属性 为 auto_increment 时，使用 insert into 插入数据不指定 id 的值，id&nbsp; 依旧可以自增长；</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">3. insert into 用法三：不指定字段名，直接写入 字段值。此方法用户写入多条数据；</p><pre style="background-color: rgb(39, 40, 34); color: rgb(207, 191, 173); font-size: 13.5pt; font-family: &quot;Source Code Pro&quot;;"><span style="color:#ff007f;">insert into </span><span style="color:#52e3f6;">test3<br></span><span style="color:#ff007f;">values </span><span style="color:#f9faf4;">(</span><span style="color:#c48cff;">3</span><span style="color:#ff007f;">, </span><span style="color:#ece47e;">'bob'</span><span style="color:#ff007f;">, </span><span style="color:#c48cff;">14</span><span style="color:#f9faf4;">)</span><span style="color:#ff007f;">,<br></span><span style="color:#ff007f;"> &nbsp; &nbsp; &nbsp; </span><span style="color:#f9faf4;">(</span><span style="color:#c48cff;">4</span><span style="color:#ff007f;">, </span><span style="color:#ece47e;">'Lilei'</span><span style="color:#ff007f;">, </span><span style="color:#c48cff;">13</span><span style="color:#f9faf4;">)</span><span style="color:#ff007f;">,<br></span><span style="color:#ff007f;"> &nbsp; &nbsp; &nbsp; </span><span style="color:#f9faf4;">(</span><span style="color:#c48cff;">5</span><span style="color:#ff007f;">, </span><span style="color:#ece47e;">'Hanmeimei'</span><span style="color:#ff007f;">, </span><span style="color:#c48cff;">14</span><span style="color:#f9faf4;">)</span><span style="color:#ff007f;">;</span></pre><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><br></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">写入多条数据时，需要写入所有字段值。多条值使用 （）扩起来，逗号[,] 区分；</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><img src="http://image.135editor.com/files/users/576/5766750/201905/PYan9FUx_ncQP.png" data-ratio="1" alt="屏幕快照 2019-05-16 下午11.46.35.png"></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><br></p></section></section></section></section><section class="_135editor" data-tools="135编辑器" data-id="2185" style="border: 0px none; box-sizing: border-box;" data-color="#80b135"><section class="_135editor" data-tools="135编辑器" data-id="2185" style="border: 0px none; box-sizing: border-box;" data-color="#80b135" data-custom="#80b135"><section style="color: inherit; font-size: 16px; padding: 5px 10px 0px 35px; margin-left: 27px; border-left: 2px dotted #e4e4e4; box-sizing: border-box;"><section class="autonum" style="width: 32px; height: 32px; margin-left: -53px; margin-top: 23px; color: #ffffff; text-align: center; line-height: 32px; border-radius: 16px; background: #80b135; box-sizing: border-box;" data-original-title="" title="" data-num="2">2</section><section class="135brush" style="margin-top: -30px; padding-bottom: 10px; font-size: 14px; text-align: justify; letter-spacing: 1.5px; color: inherit; box-sizing: border-box;"><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">replace into ：</p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><br></p></section></section></section></section><section class="_135editor" data-tools="135编辑器" data-id="2185" style="border: 0px none; box-sizing: border-box;" data-color="#80b135"><section class="_135editor" data-tools="135编辑器" data-id="2185" style="border: 0px none; box-sizing: border-box;" data-color="#80b135" data-custom="#80b135"><section style="color: inherit; font-size: 16px; padding: 5px 10px 0px 35px; margin-left: 27px; border-left: 2px dotted #e4e4e4; box-sizing: border-box;"><section class="autonum" style="width: 32px; height: 32px; margin-left: -53px; margin-top: 23px; color: #ffffff; text-align: center; line-height: 32px; border-radius: 16px; background: #80b135; box-sizing: border-box;" data-original-title="" title="" data-num="4">4</section><section class="135brush" style="margin-top: -30px; padding-bottom: 10px; font-size: 14px; text-align: justify; letter-spacing: 1.5px; color: inherit; box-sizing: border-box;"><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;">insert ignore&nbsp;<span style="letter-spacing: 0px; text-indent: 0em; caret-color: red;">：</span></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><br></p><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><br></p></section></section></section></section><p style="line-height: 1.5em; font-size: 14px; letter-spacing: 0px; color: rgb(61, 61, 61); text-indent: 0em; padding-top: 5px; padding-bottom: 5px; font-family: 微软雅黑;"><br></p></section></section>